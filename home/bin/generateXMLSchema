#!/bin/sh

#
# We need to give the generateXMLSchema the correct directory to work from
#
STARTDIR=`pwd`

#
# Check that DYNAMO_HOME and DAS_ROOT are set
#
PROGRAM_DIR=`dirname $0`
. $PROGRAM_DIR/checkDynamoHome.sh

DYNAMO_MODULES="DAS:DAS-UI"
SERVERNAME="."
TPARGS=""
SERVERCONFIGPATH=""
JAVA_ARGS="-Djava.naming.factory.initial=atg.j2ee.jndi.SerialInitContextFactory $JAVA_ARGS"

#
# Add appropriate dir or jar to config path for TransactionManager
#

SERVERCONFIGPATH="${SERVERCONFIGPATH}:localconfig"

while [ "x$1" != "x" ]
do
case $1 in
      -s) SERVERNAME="servers/$2"
          SERVERCONFIGPATH="${SERVERCONFIGPATH}:servers/$2/localconfig"
          shift
          ;;
      -m) while [ "x$2" != "x" ]
	  do
	    case $2 in
	       -*)  break;;
	   Admin*) ADMIN_MODULES="${ADMIN_MODULES}:$2" ;;
		*) ADDITIONAL_MODULES="${ADDITIONAL_MODULES}:$2" ;;
	    esac
	  shift
	  done;;
       *) TPARGS="${TPARGS} $1"
          ;;
      esac
  shift
done

if [ "x${ADDITIONAL_MODULES}" != "x" ] ; then
    DYNAMO_MODULES=${DYNAMO_MODULES}:${ADDITIONAL_MODULES}
fi

#
# Load in default environment values
#
. bin/dynamoEnv.sh

CONFIGPATH=${CONFIGPATH}$SERVERCONFIGPATH

echo -------------------
echo JAVA_ARGS:  ${JAVA_ARGS}
echo -------------------
${JAVA_VM} ${JAVA_ARGS} atg.applauncher.dynamo.DynamoServerLauncher -expand DYNAMO_MODULES: ${DYNAMO_MODULES}
echo -------------------
${JAVA_VM} ${JAVA_ARGS} atg.applauncher.dynamo.DynamoServerLauncher -expand CONFIGPATH: ${CONFIGPATH}
echo -------------------
echo CLASSPATH:  ${CLASSPATH}
echo -------------------
echo PATH:       ${PATH}

${JAVA_VM} ${JAVA_ARGS} atg.repository.xml.XMLSchemaGenerator -configPath ${CONFIGPATH} ${TPARGS}


